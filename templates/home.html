<!DOCTYPE html>
<html>
<head>
    <title>ğŸ Fridge Tracker - Fridge Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">

        <div class="nav-bar">
            <a href="{{ url_for('home') }}" class="nav-link">ğŸ Fridge</a>
            <a href="{{ url_for('shopping_list') }}" class="nav-link">ğŸ›’ Shopping List</a>
            <a href="{{ url_for('about') }}" class="nav-link">â„¹ï¸ About</a>
            <a href="{{ url_for('recipes') }}" class="nav-link">ğŸ³ Recipes</a>
                <a href="{{ url_for('bulk_add') }}" class="nav-link">â• Bulk Add</a>
            <a href="{{ url_for('price_history') }}" class="nav-link">ğŸ“Š Price History</a>
        </div>

        <h1>ğŸ Fridge Tracker</h1>
        <div style="margin-bottom: 20px;">
            <a href="{{ url_for('shopping_list') }}" style="color: #2196F3; text-decoration: none; font-size: 16px;">
                ğŸ›’ View Shopping List
            </a>
        </div>
        <p>Keep track of what's in your fridge and when it expires!</p>


        <div style="margin-bottom: 30px;">
            <a href="{{ url_for('recipes') }}" 
            style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                    color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; 
                    font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
                    transition: transform 0.3s ease, box-shadow 0.3s ease;">
                ğŸ³ Find Recipes with My Ingredients
            </a>
        </div>

        <div class="glass-card" style="margin-bottom: 30px;">
            <h2 style="color: white; margin-bottom: 20px;">â• Add New Item</h2>
            <form method="POST" action="{{ url_for('add_item') }}">
                <!-- Your form fields -->
                             <div class="form-group">
                <label for="item_name">Item Name:</label>
                <input type="text" id="item_name" name="item_name" required>
            </div>

            <div class="form-group">
                <label for="quantity">Quantity</label>
                <input type="number" name="quantity" id="quantity" required>
            </div>
            
            
            <div class="form-group">
                <label for="category">Category:</label>
                <select id="category" name="category">
                    <option value="Fruit">Fruit</option>
                    <option value="Vegetable">Vegetable</option>
                    <option value="Dairy">Dairy</option>
                    <option value="Meat">Meat</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="expiration_date">Expiration Date:</label>
                <input type="date" id="expiration_date" name="expiration_date" required>
            </div>
            
            <div class="form-group">
                <label for="location">Location:</label>
                <select id="location" name="location">
                    <option value="Fridge">Fridge</option>
                    <option value="Freezer">Freezer</option>
                    <option value="Pantry">Pantry</option>
                    <option value="Bathroom">Bathroom</option>
                </select>
            </div>

            <div class="form-group">
                <label for="store">Store (optional):</label>
                <select id="store" name="store">
                    <option value="">Not specified</option>
                    <option value="Giant">Giant (DoorDash)</option>
                    <option value="Aldi">Aldi (DoorDash)</option>
                    <option value="Walmart">Walmart</option>
                    <option value="Target">Target</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <!-- NEW: Price field -->
            <div class="form-group">
                <label for="price">Price (optional):</label>
                <input type="number" step="0.01" id="price" name="price" placeholder="4.99">
            </div>
                
                <button type="submit">Add Item</button>
            </form>
        </div>


                <!-- Expiring Soon Section -->
        {% set expiring_soon = items|selectattr('days_left', 'le', 3)|list %}

        {% if expiring_soon %}
        <div style="background-color: wheat; border-left: 4px solid #764ba2; padding: 15px; border-radius: 5px; margin-bottom: 30px;">
            
            <details>
                <summary style="cursor: pointer; font-weight: bold; font-size: 16px; color: #e65100;">
                    âš ï¸ {{ expiring_soon|length }} items expiring soon - Click to view
                </summary>
                
                <div style="margin-top: 15px;">
                    {% for item in expiring_soon %}
                    <div style="background-color: white; padding: 10px; margin-bottom: 10px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center;">
                        
                        <div>
                            <strong>{{ item.name }}</strong> (Qty: {{ item.quantity }})
                            <br>
                            <small style="color: #e65100;">
                                {% if item.days_left < 0 %}
                                    ğŸ”´ EXPIRED {{ item.days_left|abs }} days ago!
                                {% elif item.days_left == 0 %}
                                    ğŸ”´ Expires TODAY!
                                {% else %}
                                    â° Expires in {{ item.days_left }} days
                                {% endif %}
                            </small>
                        </div>
                        
                        <div style="white-space: nowrap;">
                            <form method="POST" action="{{ url_for('move_to_shopping_list', item_id=item.id) }}" style="display: inline;">
                                <button type="submit" style="background-color: #2196F3; padding: 5px 10px; border: none; border-radius: 4px; color: white; cursor: pointer; margin-right: 5px; font-size: 12px;">
                                    ğŸ›’ Shopping List
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="display: inline;">
                                <button type="submit" style="background-color: #f44336; padding: 5px 10px; border: none; border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">
                                    ğŸ—‘ï¸ Delete
                                </button>
                            </form>
                        </div>
                        
                    </div>
                    {% endfor %}
                </div>
            </details>
            
        </div>
        {% endif %}
   <!-- Current Items Section -->
        <div class="glass-card">
    <h2 style="color: white; margin-bottom: 20px;">Current Items ({{ items|length }})</h2>
    
    {% if items %}
        <!-- Group items by location -->
        {% set fridge_items = items|selectattr('location', 'eq', 'Fridge')|list %}
        {% set freezer_items = items|selectattr('location', 'eq', 'Freezer')|list %}
        {% set pantry_items = items|selectattr('location', 'eq', 'Pantry')|list %}
        {% set bathroom_items = items|selectattr('location', 'eq', 'Bathroom')|list %}
        
        <!-- Freezer Section -->
        {% if freezer_items %}
        <details open style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; font-size: 18px; font-weight: bold; user-select: none; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                ğŸ§Š Freezer ({{ freezer_items|length }} items)
            </summary>
            <div style="margin-top: 15px;">
                {% for item in freezer_items %}
                <div class="item {% if item.days_left <= 0 %}item-danger{% elif item.days_left <= 3 %}item-warning{% endif %}">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong>{{ item.name }}</strong> (Qty: {{ item.quantity }})
                            <span style="color: rgba(255, 255, 255, 0.8);">({{ item.category }})</span>
                        </div>
                        
                        <div style="white-space: nowrap; display: flex; gap: 5px;">
                            <a href="{{ url_for('edit_item', item_id=item.id) }}" style="text-decoration: none;">
                                <button type="button" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    âœï¸ Edit
                                </button>
                            </a>
                            
                            <form method="POST" action="{{ url_for('move_to_shopping_list', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ›’ Shopping List
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(244, 67, 54, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ—‘ï¸ Delete
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <small style="color: rgba(255, 255, 255, 0.9);">
                        ğŸ“… Expires: {{ item.expiration }} |
                        â° Days left: {{ item.days_left }}
                        
                        {% if item.price %}
                            | ğŸ’° ${{ "%.2f"|format(item.price) }}
                        {% endif %}
                        
                        {% if item.store %}
                            | ğŸª {{ item.store }}
                        {% endif %}
                        
                        {% if item.days_left < 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRED {{ item.days_left|abs }} days ago!</span>
                        {% elif item.days_left == 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRES TODAY!</span>
                        {% elif item.days_left <= 3 %}
                            <span style="color: #ffe082; font-weight: bold; margin-left: 10px;">âš ï¸ Expires in {{ item.days_left }} days</span>
                        {% else %}
                            <span style="color: #c8e6c9; margin-left: 10px;">âœ“ {{ item.days_left }} days left</span>
                        {% endif %}
                    </small>
                </div>
                {% endfor %}
            </div>
        </details>
        {% endif %}
        
        <!-- Fridge Section -->
        {% if fridge_items %}
        <details open style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; font-size: 18px; font-weight: bold; user-select: none; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                ğŸ¥¶ Fridge ({{ fridge_items|length }} items)
            </summary>
            <div style="margin-top: 15px;">
                {% for item in fridge_items %}
                <div class="item {% if item.days_left <= 0 %}item-danger{% elif item.days_left <= 3 %}item-warning{% endif %}">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong>{{ item.name }}</strong> (Qty: {{ item.quantity }})
                            <span style="color: rgba(255, 255, 255, 0.8);">({{ item.category }})</span>
                        </div>
                        
                        <div style="white-space: nowrap; display: flex; gap: 5px;">
                            <a href="{{ url_for('edit_item', item_id=item.id) }}" style="text-decoration: none;">
                                <button type="button" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    âœï¸ Edit
                                </button>
                            </a>
                            
                            <form method="POST" action="{{ url_for('move_to_shopping_list', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ›’ Shopping List
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(244, 67, 54, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ—‘ï¸ Delete
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <small style="color: rgba(255, 255, 255, 0.9);">
                        ğŸ“… Expires: {{ item.expiration }} |
                        â° Days left: {{ item.days_left }}
                        
                        {% if item.price %}
                            | ğŸ’° ${{ "%.2f"|format(item.price) }}
                        {% endif %}
                        
                        {% if item.store %}
                            | ğŸª {{ item.store }}
                        {% endif %}
                        
                        {% if item.days_left < 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRED {{ item.days_left|abs }} days ago!</span>
                        {% elif item.days_left == 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRES TODAY!</span>
                        {% elif item.days_left <= 3 %}
                            <span style="color: #ffe082; font-weight: bold; margin-left: 10px;">âš ï¸ Expires in {{ item.days_left }} days</span>
                        {% else %}
                            <span style="color: #c8e6c9; margin-left: 10px;">âœ“ {{ item.days_left }} days left</span>
                        {% endif %}
                    </small>
                </div>
                {% endfor %}
            </div>
        </details>
        {% endif %}
        
        <!-- Pantry Section -->
        {% if pantry_items %}
        <details open style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; font-size: 18px; font-weight: bold; user-select: none; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                ğŸº Pantry ({{ pantry_items|length }} items)
            </summary>
            <div style="margin-top: 15px;">
                {% for item in pantry_items %}
                <div class="item {% if item.days_left <= 0 %}item-danger{% elif item.days_left <= 3 %}item-warning{% endif %}">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong>{{ item.name }}</strong> (Qty: {{ item.quantity }})
                            <span style="color: rgba(255, 255, 255, 0.8);">({{ item.category }})</span>
                        </div>
                        
                        <div style="white-space: nowrap; display: flex; gap: 5px;">
                            <a href="{{ url_for('edit_item', item_id=item.id) }}" style="text-decoration: none;">
                                <button type="button" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    âœï¸ Edit
                                </button>
                            </a>
                            
                            <form method="POST" action="{{ url_for('move_to_shopping_list', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ›’ Shopping List
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(244, 67, 54, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ—‘ï¸ Delete
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <small style="color: rgba(255, 255, 255, 0.9);">
                        ğŸ“… Expires: {{ item.expiration }} |
                        â° Days left: {{ item.days_left }}
                        
                        {% if item.price %}
                            | ğŸ’° ${{ "%.2f"|format(item.price) }}
                        {% endif %}
                        
                        {% if item.store %}
                            | ğŸª {{ item.store }}
                        {% endif %}
                        
                        {% if item.days_left < 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRED {{ item.days_left|abs }} days ago!</span>
                        {% elif item.days_left == 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRES TODAY!</span>
                        {% elif item.days_left <= 3 %}
                            <span style="color: #ffe082; font-weight: bold; margin-left: 10px;">âš ï¸ Expires in {{ item.days_left }} days</span>
                        {% else %}
                            <span style="color: #c8e6c9; margin-left: 10px;">âœ“ {{ item.days_left }} days left</span>
                        {% endif %}
                    </small>
                </div>
                {% endfor %}
            </div>
        </details>
        {% endif %}
        
        <!-- Bathroom Section -->
        {% if bathroom_items %}
        <details open style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; font-size: 18px; font-weight: bold; user-select: none; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                ğŸš¿ Bathroom ({{ bathroom_items|length }} items)
            </summary>
            <div style="margin-top: 15px;">
                {% for item in bathroom_items %}
                <div class="item {% if item.days_left <= 0 %}item-danger{% elif item.days_left <= 3 %}item-warning{% endif %}">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong>{{ item.name }}</strong> (Qty: {{ item.quantity }})
                            <span style="color: rgba(255, 255, 255, 0.8);">({{ item.category }})</span>
                        </div>
                        
                        <div style="white-space: nowrap; display: flex; gap: 5px;">
                            <a href="{{ url_for('edit_item', item_id=item.id) }}" style="text-decoration: none;">
                                <button type="button" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    âœï¸ Edit
                                </button>
                            </a>
                            
                            <form method="POST" action="{{ url_for('move_to_shopping_list', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(33, 150, 243, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ›’ Shopping List
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="display: inline; margin: 0;">
                                <button type="submit" style="background: rgba(244, 67, 54, 0.8); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; font-size: 12px; border-radius: 8px;">
                                    ğŸ—‘ï¸ Delete
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <small style="color: rgba(255, 255, 255, 0.9);">
                        ğŸ“… Expires: {{ item.expiration }} |
                        â° Days left: {{ item.days_left }}
                        
                        {% if item.price %}
                            | ğŸ’° ${{ "%.2f"|format(item.price) }}
                        {% endif %}
                        
                        {% if item.store %}
                            | ğŸª {{ item.store }}
                        {% endif %}
                        
                        {% if item.days_left < 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRED {{ item.days_left|abs }} days ago!</span>
                        {% elif item.days_left == 0 %}
                            <span style="color: #ffcdd2; font-weight: bold; margin-left: 10px;">ğŸ”´ EXPIRES TODAY!</span>
                        {% elif item.days_left <= 3 %}
                            <span style="color: #ffe082; font-weight: bold; margin-left: 10px;">âš ï¸ Expires in {{ item.days_left }} days</span>
                        {% else %}
                            <span style="color: #c8e6c9; margin-left: 10px;">âœ“ {{ item.days_left }} days left</span>
                        {% endif %}
                    </small>
                </div>
                {% endfor %}
            </div>
        </details>
        {% endif %}
        
    {% else %}
        <p style="color: rgba(255, 255, 255, 0.7); text-align: center; padding: 40px;">
            <em>No items in your fridge yet. Add your first item above!</em>
        </p>
    {% endif %}
</div>

    <div style="
        /* The core Glassmorphism properties: transparency and blur */
        background: rgba(255, 255, 255, 0.15); /* Semi-transparent white */
        backdrop-filter: blur(10px); /* The frosted glass effect */
        -webkit-backdrop-filter: blur(10px); /* For Safari support */
        
        /* Standard modern card properties */
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 20px;
        
        /* Subtle border for definition and light shadow for depth */
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        
        /* Text color for contrast */
        color: #f0f0f0; /* Light text for dark backgrounds */
    ">
        <h3 style="margin-top: 0; margin-bottom: 25px; font-size: 1.75rem; font-weight: 700; color: #ffffff;">ğŸ“Š Category Breakdown</h3>
        {% set fruit_count = items|selectattr('category', 'eq', 'Fruit')|list|length %}
        {% set vegetable_count = items|selectattr('category', 'eq', 'Vegetable')|list|length %}
        {% set dairy_count = items|selectattr('category', 'eq', 'Dairy')|list|length %}
        {% set meat_count = items|selectattr('category', 'eq', 'Meat')|list|length %}
        {% set other_count = items|selectattr('category', 'eq', 'Other')|list|length %}
        <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 12px; font-size: 1.1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 5px;">**Fruit**: {{ fruit_count }} items</li>
            <li style="margin-bottom: 12px; font-size: 1.1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 5px;">**Vegetable**: {{ vegetable_count }} items</li>
            <li style="margin-bottom: 12px; font-size: 1.1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 5px;">**Dairy**: {{ dairy_count }} items</li>
            <li style="margin-bottom: 12px; font-size: 1.1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 5px;">**Meat**: {{ meat_count }} items</li>
            <li style="margin-bottom: 0; font-size: 1.1rem;">**Other**: {{ other_count }} items</li>
        </ul>
    </div>

</div>
</body>
</html>